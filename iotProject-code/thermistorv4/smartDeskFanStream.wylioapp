{"main":"[{\"type\":\"tab\",\"id\":\"18a30e1.772d3f2\",\"label\":\"Flow 1\"},{\"id\":\"c25fe361.f6aef\",\"type\":\"serial-port\",\"z\":\"18a30e1.772d3f2\",\"serialport\":\"/dev/ttyACM0\",\"serialbaud\":\"9600\",\"databits\":\"8\",\"parity\":\"none\",\"stopbits\":\"1\",\"newline\":\"\\\\n\",\"bin\":\"false\",\"out\":\"char\",\"addchar\":false},{\"id\":\"93b26da6.f08ee\",\"type\":\"serial in\",\"z\":\"18a30e1.772d3f2\",\"name\":\"TempData\",\"serial\":\"c25fe361.f6aef\",\"x\":194,\"y\":144,\"wires\":[[\"f2ae537f.dab82\",\"5add3df3.03a894\"]]},{\"id\":\"f2ae537f.dab82\",\"type\":\"print\",\"z\":\"18a30e1.772d3f2\",\"name\":\"\",\"active\":true,\"field\":\"\",\"complete\":\"false\",\"x\":462,\"y\":150,\"wires\":[]},{\"id\":\"5add3df3.03a894\",\"type\":\"sendsignal\",\"z\":\"18a30e1.772d3f2\",\"name\":\"Temp\",\"signal\":\"temp\",\"to\":\"dashboard\",\"deviceid\":\"\",\"x\":410,\"y\":80,\"wires\":[]},{\"id\":\"25573da9.84fa22\",\"type\":\"serial out\",\"z\":\"18a30e1.772d3f2\",\"name\":\"\",\"serial\":\"c25fe361.f6aef\",\"x\":452,\"y\":249,\"wires\":[]},{\"id\":\"8cf3087a.e50b78\",\"type\":\"receivesignal\",\"z\":\"18a30e1.772d3f2\",\"name\":\"threshold\",\"signal\":\"threshold\",\"x\":124,\"y\":226,\"wires\":[[\"c412f72b.04cb48\"]]},{\"id\":\"c412f72b.04cb48\",\"type\":\"delay\",\"z\":\"18a30e1.772d3f2\",\"name\":\"\",\"pauseType\":\"delay\",\"timeout\":\"1\",\"timeoutUnits\":\"seconds\",\"rate\":\"1\",\"rateUnits\":\"second\",\"randomFirst\":\"1\",\"randomLast\":\"5\",\"randomUnits\":\"seconds\",\"drop\":false,\"x\":284,\"y\":285,\"wires\":[[\"25573da9.84fa22\"]]},{\"id\":\"8a5f6c59.f4fbc\",\"type\":\"visual\",\"z\":\"18a30e1.772d3f2\",\"name\":\"\",\"func\":\"\\nreturn msg;\",\"xmlvisual\":\"<xml xmlns=\\\"http://www.w3.org/1999/xhtml\\\"><block type=\\\"variables_set\\\" id=\\\"1\\\" inline=\\\"true\\\" x=\\\"61\\\" y=\\\"43\\\"><field name=\\\"VAR\\\">new message</field><value name=\\\"VALUE\\\"><block type=\\\"visual_new_message\\\" id=\\\"2\\\"></block></value><next><block type=\\\"visual_msg_set\\\" id=\\\"27\\\" inline=\\\"true\\\"><value name=\\\"payload\\\"><block type=\\\"text\\\" id=\\\"28\\\"><field name=\\\"TEXT\\\">payload</field></block></value><value name=\\\"val\\\"><block type=\\\"text\\\" id=\\\"29\\\"><field name=\\\"TEXT\\\">value</field></block></value><next><block type=\\\"visual_ret\\\" id=\\\"3\\\" inline=\\\"true\\\"><value name=\\\"msg\\\"><block type=\\\"variables_get\\\" id=\\\"4\\\"><field name=\\\"VAR\\\">new message</field></block></value></block></next></block></next></block></xml>\",\"outputs\":1,\"x\":310,\"y\":371,\"wires\":[[]]}]","language":"streams","title":"smartDeskFanStream","date":1490960017679,"firmware":"#include <math.h>\n\nint threshold = 23;\nint sensorPin = A0;\nint sensorValue = 0;\nint relayPin = 7;\ndouble tempInCelcius = 0;\n\n\nvoid setup() {\n  Serial.begin(9600);\n  pinMode(sensorPin, INPUT);\n  pinMode(relayPin, OUTPUT);\n}\n\nvoid loop() {\n  sensorValue =  analogRead(sensorPin);\n  if(Serial.available() > 0){\n  threshold = Serial.parseInt(); \n  }\n  fan(sensorValue);\n  tempInCelcius = thermistor(sensorValue);\n  sensor();\n}\n\nvoid sensor(){\n  Serial.println(tempInCelcius);\n  Serial.println(threshold);\n  delay(sensorValue); \n}\n\nvoid fan(int sensorValue){\n  \n    if(tempInCelcius > threshold){\n    Serial.println(\"Turn on Fan\");\n    digitalWrite(relayPin,HIGH);\n  }\n  \n  else if(tempInCelcius < threshold){\n    digitalWrite(relayPin,LOW);\n  }\n}\n\ndouble thermistor(int sensorValue){\n  double temp;\n  \n  temp= log(10000.0*((1441.0/sensorValue-1)));\n  \n  temp = 1/(0.001129148 + (0.000234125 +(0.0000000876741 *temp* temp))*temp);\n  temp =temp - 273.15;\n  return temp;\n}\n\n\n","dashboard":[{"title":"temp","color":"#e54225","properties":{"title":"Temp","minAxisValue":0,"maxAxisValue":100,"axisName":""},"style":"thermometer","values":true},{"title":"threshold","color":"#e54225","properties":{"title":"threshold","minimum_value":0,"maximum_value":100,"step":1},"style":"slider"}]}